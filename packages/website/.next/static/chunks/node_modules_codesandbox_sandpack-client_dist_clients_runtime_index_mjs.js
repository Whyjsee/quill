"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_codesandbox_sandpack-client_dist_clients_runtime_index_mjs"],{

/***/ "../../node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs":
/*!******************************************************************************!*\
  !*** ../../node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs ***!
  \******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   S: function() { return /* binding */ SandpackClient; }\n/* harmony export */ });\n/* harmony import */ var dequal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dequal */ \"../../node_modules/dequal/dist/index.mjs\");\n\n\nvar SandpackClient = /** @class */ (function () {\n    function SandpackClient(iframeSelector, sandboxSetup, options) {\n        if (options === void 0) { options = {}; }\n        this.status = \"idle\";\n        this.options = options;\n        this.sandboxSetup = sandboxSetup;\n        this.iframeSelector = iframeSelector;\n    }\n    /**\n     * Clients handles\n     */\n    SandpackClient.prototype.updateOptions = function (options) {\n        if (!(0,dequal__WEBPACK_IMPORTED_MODULE_0__.dequal)(this.options, options)) {\n            this.options = options;\n            this.updateSandbox();\n        }\n    };\n    SandpackClient.prototype.updateSandbox = function (_sandboxSetup, _isInitializationCompile) {\n        if (_sandboxSetup === void 0) { _sandboxSetup = this.sandboxSetup; }\n        throw Error(\"Method not implemented\");\n    };\n    SandpackClient.prototype.destroy = function () {\n        throw Error(\"Method not implemented\");\n    };\n    /**\n     * Bundler communication\n     */\n    SandpackClient.prototype.dispatch = function (_message) {\n        throw Error(\"Method not implemented\");\n    };\n    SandpackClient.prototype.listen = function (_listener) {\n        throw Error(\"Method not implemented\");\n    };\n    return SandpackClient;\n}());\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vbm9kZV9tb2R1bGVzL0Bjb2Rlc2FuZGJveC9zYW5kcGFjay1jbGllbnQvZGlzdC9iYXNlLTgwYTFmNzYwLm1qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFnQzs7QUFFaEM7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDhDQUFNO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFOEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4uLy4uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvYmFzZS04MGExZjc2MC5tanM/NGQ5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXF1YWwgfSBmcm9tICdkZXF1YWwnO1xuXG52YXIgU2FuZHBhY2tDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2FuZHBhY2tDbGllbnQoaWZyYW1lU2VsZWN0b3IsIHNhbmRib3hTZXR1cCwgb3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICB0aGlzLnN0YXR1cyA9IFwiaWRsZVwiO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLnNhbmRib3hTZXR1cCA9IHNhbmRib3hTZXR1cDtcbiAgICAgICAgdGhpcy5pZnJhbWVTZWxlY3RvciA9IGlmcmFtZVNlbGVjdG9yO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGllbnRzIGhhbmRsZXNcbiAgICAgKi9cbiAgICBTYW5kcGFja0NsaWVudC5wcm90b3R5cGUudXBkYXRlT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIGlmICghZGVxdWFsKHRoaXMub3B0aW9ucywgb3B0aW9ucykpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNhbmRib3goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2FuZHBhY2tDbGllbnQucHJvdG90eXBlLnVwZGF0ZVNhbmRib3ggPSBmdW5jdGlvbiAoX3NhbmRib3hTZXR1cCwgX2lzSW5pdGlhbGl6YXRpb25Db21waWxlKSB7XG4gICAgICAgIGlmIChfc2FuZGJveFNldHVwID09PSB2b2lkIDApIHsgX3NhbmRib3hTZXR1cCA9IHRoaXMuc2FuZGJveFNldHVwOyB9XG4gICAgICAgIHRocm93IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICB9O1xuICAgIFNhbmRwYWNrQ2xpZW50LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWRcIik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBCdW5kbGVyIGNvbW11bmljYXRpb25cbiAgICAgKi9cbiAgICBTYW5kcGFja0NsaWVudC5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoX21lc3NhZ2UpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkXCIpO1xuICAgIH07XG4gICAgU2FuZHBhY2tDbGllbnQucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChfbGlzdGVuZXIpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkXCIpO1xuICAgIH07XG4gICAgcmV0dXJuIFNhbmRwYWNrQ2xpZW50O1xufSgpKTtcblxuZXhwb3J0IHsgU2FuZHBhY2tDbGllbnQgYXMgUyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../../node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs\n"));

/***/ }),

/***/ "../../node_modules/@codesandbox/sandpack-client/dist/clients/runtime/index.mjs":
/*!**************************************************************************************!*\
  !*** ../../node_modules/@codesandbox/sandpack-client/dist/clients/runtime/index.mjs ***!
  \**************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SandpackRuntime: function() { return /* binding */ SandpackRuntime; }\n/* harmony export */ });\n/* harmony import */ var _types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../types-0877c553.mjs */ \"../../node_modules/@codesandbox/sandpack-client/dist/types-0877c553.mjs\");\n/* harmony import */ var dequal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dequal */ \"../../node_modules/dequal/dist/index.mjs\");\n/* harmony import */ var _base_80a1f760_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../base-80a1f760.mjs */ \"../../node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs\");\n/* harmony import */ var outvariant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! outvariant */ \"../../node_modules/outvariant/lib/index.mjs\");\n\n\n\n\n\n/**\n * This file is a copy of the resolver from the `codesandbox-api` package.\n * We wanted to avoid to reference codesandbox-api because of the code that runs on load in the package.\n * The plan is to take some time and refactor codesandbox-api into what it was supposed to be in the first place,\n * an abstraction over the actions that can be dispatched between the bundler and the iframe.\n */\nvar Protocol = /** @class */ (function () {\n    function Protocol(type, handleMessage, protocol) {\n        var _this = this;\n        this.type = type;\n        this.handleMessage = handleMessage;\n        this.protocol = protocol;\n        this._disposeMessageListener = this.protocol.channelListen(function (msg) { return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__._)(_this, void 0, void 0, function () {\n            var message, result, response, err_1, response;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(msg.type === this.getTypeId() && msg.method)) return [3 /*break*/, 4];\n                        message = msg;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.handleMessage(message)];\n                    case 2:\n                        result = _a.sent();\n                        response = {\n                            type: this.getTypeId(),\n                            msgId: message.msgId,\n                            result: result,\n                        };\n                        this.protocol.dispatch(response);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_1 = _a.sent();\n                        response = {\n                            type: this.getTypeId(),\n                            msgId: message.msgId,\n                            error: {\n                                message: err_1.message,\n                            },\n                        };\n                        this.protocol.dispatch(response);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); });\n    }\n    Protocol.prototype.getTypeId = function () {\n        return \"protocol-\".concat(this.type);\n    };\n    Protocol.prototype.dispose = function () {\n        this._disposeMessageListener();\n    };\n    return Protocol;\n}());\n\nvar IFrameProtocol = /** @class */ (function () {\n    function IFrameProtocol(iframe, origin) {\n        // React to messages from any iframe\n        this.globalListeners = {};\n        this.globalListenersCount = 0;\n        // React to messages from the iframe owned by this instance\n        this.channelListeners = {};\n        this.channelListenersCount = 0;\n        // Random number to identify this instance of the client when messages are coming from multiple iframes\n        this.channelId = Math.floor(Math.random() * 1000000);\n        this.frameWindow = iframe.contentWindow;\n        this.origin = origin;\n        this.globalListeners = [];\n        this.channelListeners = [];\n        this.eventListener = this.eventListener.bind(this);\n        if (typeof window !== \"undefined\") {\n            window.addEventListener(\"message\", this.eventListener);\n        }\n    }\n    IFrameProtocol.prototype.cleanup = function () {\n        window.removeEventListener(\"message\", this.eventListener);\n        this.globalListeners = {};\n        this.channelListeners = {};\n        this.globalListenersCount = 0;\n        this.channelListenersCount = 0;\n    };\n    // Sends the channelId and triggers an iframeHandshake promise to resolve,\n    // so the iframe can start listening for messages (based on the id)\n    IFrameProtocol.prototype.register = function () {\n        if (!this.frameWindow) {\n            return;\n        }\n        this.frameWindow.postMessage({\n            type: \"register-frame\",\n            origin: document.location.origin,\n            id: this.channelId,\n        }, this.origin);\n    };\n    // Messages are dispatched from the client directly to the instance iframe\n    IFrameProtocol.prototype.dispatch = function (message) {\n        if (!this.frameWindow) {\n            return;\n        }\n        this.frameWindow.postMessage((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)({ $id: this.channelId, codesandbox: true }, message), this.origin);\n    };\n    // Add a listener that is called on any message coming from an iframe in the page\n    // This is needed for the `initialize` message which comes without a channelId\n    IFrameProtocol.prototype.globalListen = function (listener) {\n        var _this = this;\n        if (typeof listener !== \"function\") {\n            return function () {\n                return;\n            };\n        }\n        var listenerId = this.globalListenersCount;\n        this.globalListeners[listenerId] = listener;\n        this.globalListenersCount++;\n        return function () {\n            delete _this.globalListeners[listenerId];\n        };\n    };\n    // Add a listener that is called on any message coming from an iframe with the instance channelId\n    // All other messages (eg: from other iframes) are ignored\n    IFrameProtocol.prototype.channelListen = function (listener) {\n        var _this = this;\n        if (typeof listener !== \"function\") {\n            return function () {\n                return;\n            };\n        }\n        var listenerId = this.channelListenersCount;\n        this.channelListeners[listenerId] = listener;\n        this.channelListenersCount++;\n        return function () {\n            delete _this.channelListeners[listenerId];\n        };\n    };\n    // Handles message windows coming from iframes\n    IFrameProtocol.prototype.eventListener = function (evt) {\n        // skip events originating from different iframes\n        if (evt.source !== this.frameWindow) {\n            return;\n        }\n        var message = evt.data;\n        if (!message.codesandbox) {\n            return;\n        }\n        Object.values(this.globalListeners).forEach(function (listener) {\n            return listener(message);\n        });\n        if (message.$id !== this.channelId) {\n            return;\n        }\n        Object.values(this.channelListeners).forEach(function (listener) {\n            return listener(message);\n        });\n    };\n    return IFrameProtocol;\n}());\n\nvar MAX_CLIENT_DEPENDENCY_COUNT = 50;\nfunction getTemplate(pkg, \n/* eslint-disable @typescript-eslint/no-explicit-any */\nmodules) {\n    if (!pkg) {\n        return \"static\";\n    }\n    var _a = pkg.dependencies, dependencies = _a === void 0 ? {} : _a, _b = pkg.devDependencies, devDependencies = _b === void 0 ? {} : _b;\n    var totalDependencies = (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.i)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.i)([], Object.keys(dependencies), true), Object.keys(devDependencies), true);\n    var moduleNames = Object.keys(modules);\n    var adonis = [\"@adonisjs/framework\", \"@adonisjs/core\"];\n    if (totalDependencies.some(function (dep) { return adonis.indexOf(dep) > -1; })) {\n        return \"adonis\";\n    }\n    var nuxt = [\"nuxt\", \"nuxt-edge\", \"nuxt-ts\", \"nuxt-ts-edge\", \"nuxt3\"];\n    if (totalDependencies.some(function (dep) { return nuxt.indexOf(dep) > -1; })) {\n        return \"nuxt\";\n    }\n    if (totalDependencies.indexOf(\"next\") > -1) {\n        return \"next\";\n    }\n    var apollo = [\n        \"apollo-server\",\n        \"apollo-server-express\",\n        \"apollo-server-hapi\",\n        \"apollo-server-koa\",\n        \"apollo-server-lambda\",\n        \"apollo-server-micro\",\n    ];\n    if (totalDependencies.some(function (dep) { return apollo.indexOf(dep) > -1; })) {\n        return \"apollo\";\n    }\n    if (totalDependencies.indexOf(\"mdx-deck\") > -1) {\n        return \"mdx-deck\";\n    }\n    if (totalDependencies.indexOf(\"gridsome\") > -1) {\n        return \"gridsome\";\n    }\n    if (totalDependencies.indexOf(\"vuepress\") > -1) {\n        return \"vuepress\";\n    }\n    if (totalDependencies.indexOf(\"ember-cli\") > -1) {\n        return \"ember\";\n    }\n    if (totalDependencies.indexOf(\"sapper\") > -1) {\n        return \"sapper\";\n    }\n    if (totalDependencies.indexOf(\"gatsby\") > -1) {\n        return \"gatsby\";\n    }\n    if (totalDependencies.indexOf(\"quasar\") > -1) {\n        return \"quasar\";\n    }\n    if (totalDependencies.indexOf(\"@docusaurus/core\") > -1) {\n        return \"docusaurus\";\n    }\n    if (totalDependencies.indexOf(\"remix\") > -1) {\n        return \"remix\";\n    }\n    if (totalDependencies.indexOf(\"astro\") > -1) {\n        return \"node\";\n    }\n    // CLIENT\n    if (moduleNames.some(function (m) { return m.endsWith(\".re\"); })) {\n        return \"reason\";\n    }\n    var parcel = [\"parcel-bundler\", \"parcel\"];\n    if (totalDependencies.some(function (dep) { return parcel.indexOf(dep) > -1; })) {\n        return \"parcel\";\n    }\n    var dojo = [\"@dojo/core\", \"@dojo/framework\"];\n    if (totalDependencies.some(function (dep) { return dojo.indexOf(dep) > -1; })) {\n        return \"@dojo/cli-create-app\";\n    }\n    if (totalDependencies.indexOf(\"@nestjs/core\") > -1 ||\n        totalDependencies.indexOf(\"@nestjs/common\") > -1) {\n        return \"nest\";\n    }\n    if (totalDependencies.indexOf(\"react-styleguidist\") > -1) {\n        return \"styleguidist\";\n    }\n    if (totalDependencies.indexOf(\"react-scripts\") > -1) {\n        return \"create-react-app\";\n    }\n    if (totalDependencies.indexOf(\"react-scripts-ts\") > -1) {\n        return \"create-react-app-typescript\";\n    }\n    if (totalDependencies.indexOf(\"@angular/core\") > -1) {\n        return \"angular-cli\";\n    }\n    if (totalDependencies.indexOf(\"preact-cli\") > -1) {\n        return \"preact-cli\";\n    }\n    if (totalDependencies.indexOf(\"@sveltech/routify\") > -1 ||\n        totalDependencies.indexOf(\"@roxi/routify\") > -1) {\n        return \"node\";\n    }\n    if (totalDependencies.indexOf(\"vite\") > -1) {\n        return \"node\";\n    }\n    if (totalDependencies.indexOf(\"@frontity/core\") > -1) {\n        return \"node\";\n    }\n    if (totalDependencies.indexOf(\"svelte\") > -1) {\n        return \"svelte\";\n    }\n    if (totalDependencies.indexOf(\"vue\") > -1) {\n        return \"vue-cli\";\n    }\n    if (totalDependencies.indexOf(\"cx\") > -1) {\n        return \"cxjs\";\n    }\n    var nodeDeps = [\n        \"express\",\n        \"koa\",\n        \"nodemon\",\n        \"ts-node\",\n        \"@tensorflow/tfjs-node\",\n        \"webpack-dev-server\",\n        \"snowpack\",\n    ];\n    if (totalDependencies.some(function (dep) { return nodeDeps.indexOf(dep) > -1; })) {\n        return \"node\";\n    }\n    if (Object.keys(dependencies).length >= MAX_CLIENT_DEPENDENCY_COUNT) {\n        // The dependencies are too much for client sandboxes to handle\n        return \"node\";\n    }\n    return undefined;\n}\n\nvar _a;\nvar BUNDLER_URL = \"https://\".concat((_a = \"2.13.2\") === null || _a === void 0 ? void 0 : _a.replace(/\\./g, \"-\"), \"-sandpack.codesandbox.io/\");\nvar SandpackRuntime = /** @class */ (function (_super) {\n    (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.g)(SandpackRuntime, _super);\n    function SandpackRuntime(selector, sandboxSetup, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, selector, sandboxSetup, options) || this;\n        _this.getTranspilerContext = function () {\n            return new Promise(function (resolve) {\n                var unsubscribe = _this.listen(function (message) {\n                    if (message.type === \"transpiler-context\") {\n                        resolve(message.data);\n                        unsubscribe();\n                    }\n                });\n                _this.dispatch({ type: \"get-transpiler-context\" });\n            });\n        };\n        _this.bundlerURL = options.bundlerURL || BUNDLER_URL;\n        if (options.teamId) {\n            _this.bundlerURL =\n                _this.bundlerURL.replace(\"https://\", \"https://\" + options.teamId + \"-\") +\n                    \"?cache=\".concat(Date.now());\n        }\n        _this.bundlerState = undefined;\n        _this.errors = [];\n        _this.status = \"initializing\";\n        if (typeof selector === \"string\") {\n            _this.selector = selector;\n            var element = document.querySelector(selector);\n            (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.n)(element, \"The element '\".concat(selector, \"' was not found\"));\n            _this.element = element;\n            _this.iframe = document.createElement(\"iframe\");\n            _this.initializeElement();\n        }\n        else {\n            _this.element = selector;\n            _this.iframe = selector;\n        }\n        if (!_this.iframe.getAttribute(\"sandbox\")) {\n            _this.iframe.setAttribute(\"sandbox\", \"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts allow-downloads allow-pointer-lock\");\n            _this.iframe.setAttribute(\"allow\", \"accelerometer; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; clipboard-write;\");\n        }\n        _this.setLocationURLIntoIFrame();\n        _this.iframeProtocol = new IFrameProtocol(_this.iframe, _this.bundlerURL);\n        _this.unsubscribeGlobalListener = _this.iframeProtocol.globalListen(function (mes) {\n            if (mes.type !== \"initialized\" || !_this.iframe.contentWindow) {\n                return;\n            }\n            _this.iframeProtocol.register();\n            if (_this.options.fileResolver) {\n                _this.fileResolverProtocol = new Protocol(\"fs\", function (data) { return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__._)(_this, void 0, void 0, function () {\n                    return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.a)(this, function (_a) {\n                        if (data.method === \"isFile\") {\n                            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                            return [2 /*return*/, this.options.fileResolver.isFile(data.params[0])];\n                        }\n                        else if (data.method === \"readFile\") {\n                            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                            return [2 /*return*/, this.options.fileResolver.readFile(data.params[0])];\n                        }\n                        else {\n                            throw new Error(\"Method not supported\");\n                        }\n                    });\n                }); }, _this.iframeProtocol);\n            }\n            _this.updateSandbox(_this.sandboxSetup, true);\n        });\n        _this.unsubscribeChannelListener = _this.iframeProtocol.channelListen(function (mes) {\n            switch (mes.type) {\n                case \"start\": {\n                    _this.errors = [];\n                    break;\n                }\n                case \"status\": {\n                    _this.status = mes.status;\n                    break;\n                }\n                case \"action\": {\n                    if (mes.action === \"show-error\") {\n                        _this.errors = (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.i)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.i)([], _this.errors, true), [(0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.e)(mes)], false);\n                    }\n                    break;\n                }\n                case \"done\": {\n                    _this.status = \"done\";\n                    break;\n                }\n                case \"state\": {\n                    _this.bundlerState = mes.state;\n                    break;\n                }\n            }\n        });\n        return _this;\n    }\n    SandpackRuntime.prototype.setLocationURLIntoIFrame = function () {\n        var _a;\n        var urlSource = this.options.startRoute\n            ? new URL(this.options.startRoute, this.bundlerURL).toString()\n            : this.bundlerURL;\n        (_a = this.iframe.contentWindow) === null || _a === void 0 ? void 0 : _a.location.replace(urlSource);\n        this.iframe.src = urlSource;\n    };\n    SandpackRuntime.prototype.destroy = function () {\n        this.unsubscribeChannelListener();\n        this.unsubscribeGlobalListener();\n        this.iframeProtocol.cleanup();\n    };\n    SandpackRuntime.prototype.updateOptions = function (options) {\n        if (!(0,dequal__WEBPACK_IMPORTED_MODULE_0__.dequal)(this.options, options)) {\n            this.options = options;\n            this.updateSandbox();\n        }\n    };\n    SandpackRuntime.prototype.updateSandbox = function (sandboxSetup, isInitializationCompile) {\n        var _a, _b, _c, _d;\n        if (sandboxSetup === void 0) { sandboxSetup = this.sandboxSetup; }\n        this.sandboxSetup = (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)({}, this.sandboxSetup), sandboxSetup);\n        var files = this.getFiles();\n        var modules = Object.keys(files).reduce(function (prev, next) {\n            var _a;\n            return ((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)({}, prev), (_a = {}, _a[next] = {\n                code: files[next].code,\n                path: next,\n            }, _a)));\n        }, {});\n        var packageJSON = JSON.parse((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.b)(this.sandboxSetup.dependencies, this.sandboxSetup.devDependencies, this.sandboxSetup.entry));\n        try {\n            packageJSON = JSON.parse(files[\"/package.json\"].code);\n        }\n        catch (e) {\n            console.error((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.c)(\"could not parse package.json file: \" + e.message));\n        }\n        // TODO move this to a common format\n        var normalizedModules = Object.keys(files).reduce(function (prev, next) {\n            var _a;\n            return ((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)({}, prev), (_a = {}, _a[next] = {\n                content: files[next].code,\n                path: next,\n            }, _a)));\n        }, {});\n        this.dispatch((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)({}, this.options), { type: \"compile\", codesandbox: true, version: 3, isInitializationCompile: isInitializationCompile, modules: modules, reactDevTools: this.options.reactDevTools, externalResources: this.options.externalResources || [], hasFileResolver: Boolean(this.options.fileResolver), disableDependencyPreprocessing: this.sandboxSetup.disableDependencyPreprocessing, template: this.sandboxSetup.template ||\n                getTemplate(packageJSON, normalizedModules), showOpenInCodeSandbox: (_a = this.options.showOpenInCodeSandbox) !== null && _a !== void 0 ? _a : true, showErrorScreen: (_b = this.options.showErrorScreen) !== null && _b !== void 0 ? _b : true, showLoadingScreen: (_c = this.options.showLoadingScreen) !== null && _c !== void 0 ? _c : false, skipEval: this.options.skipEval || false, clearConsoleDisabled: !this.options.clearConsoleOnFirstCompile, logLevel: (_d = this.options.logLevel) !== null && _d !== void 0 ? _d : _types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.S.Info, customNpmRegistries: this.options.customNpmRegistries, teamId: this.options.teamId, sandboxId: this.options.sandboxId }));\n    };\n    SandpackRuntime.prototype.dispatch = function (message) {\n        /**\n         * Intercept \"refresh\" dispatch: this will make sure\n         * that the iframe is still in the location it's supposed to be.\n         * External links inside the iframe will change the location and\n         * prevent the user from navigating back.\n         */\n        if (message.type === \"refresh\") {\n            this.setLocationURLIntoIFrame();\n        }\n        this.iframeProtocol.dispatch(message);\n    };\n    SandpackRuntime.prototype.listen = function (listener) {\n        return this.iframeProtocol.channelListen(listener);\n    };\n    /**\n     * Get the URL of the contents of the current sandbox\n     */\n    SandpackRuntime.prototype.getCodeSandboxURL = function () {\n        var files = this.getFiles();\n        var paramFiles = Object.keys(files).reduce(function (prev, next) {\n            var _a;\n            return ((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.h)({}, prev), (_a = {}, _a[next.replace(\"/\", \"\")] = {\n                content: files[next].code,\n                isBinary: false,\n            }, _a)));\n        }, {});\n        return fetch(\"https://codesandbox.io/api/v1/sandboxes/define?json=1\", {\n            method: \"POST\",\n            body: JSON.stringify({ files: paramFiles }),\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\",\n            },\n        })\n            .then(function (x) { return x.json(); })\n            .then(function (res) { return ({\n            sandboxId: res.sandbox_id,\n            editorUrl: \"https://codesandbox.io/s/\".concat(res.sandbox_id),\n            embedUrl: \"https://codesandbox.io/embed/\".concat(res.sandbox_id),\n        }); });\n    };\n    SandpackRuntime.prototype.getFiles = function () {\n        var sandboxSetup = this.sandboxSetup;\n        if (sandboxSetup.files[\"/package.json\"] === undefined) {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.d)(sandboxSetup.files, sandboxSetup.dependencies, sandboxSetup.devDependencies, sandboxSetup.entry);\n        }\n        return this.sandboxSetup.files;\n    };\n    SandpackRuntime.prototype.initializeElement = function () {\n        this.iframe.style.border = \"0\";\n        this.iframe.style.width = this.options.width || \"100%\";\n        this.iframe.style.height = this.options.height || \"100%\";\n        this.iframe.style.overflow = \"hidden\";\n        (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_2__.n)(this.element.parentNode, \"The given iframe does not have a parent.\");\n        this.element.parentNode.replaceChild(this.iframe, this.element);\n    };\n    return SandpackRuntime;\n}(_base_80a1f760_mjs__WEBPACK_IMPORTED_MODULE_3__.S));\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vbm9kZV9tb2R1bGVzL0Bjb2Rlc2FuZGJveC9zYW5kcGFjay1jbGllbnQvZGlzdC9jbGllbnRzL3J1bnRpbWUvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXdRO0FBQ3hPO0FBQzhCO0FBQzFDOztBQUVwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRkFBb0YsT0FBTyxzREFBUztBQUNwRztBQUNBLG1CQUFtQixzREFBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTLElBQUk7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHNEQUFRLEdBQUcsd0NBQXdDO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLHFFQUFxRTtBQUN0SSw0QkFBNEIsc0RBQWEsQ0FBQyxzREFBYTtBQUN2RDtBQUNBO0FBQ0EsZ0RBQWdELGtDQUFrQztBQUNsRjtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsZ0NBQWdDO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELGtDQUFrQztBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsMkJBQTJCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxrQ0FBa0M7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELGdDQUFnQztBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxvQ0FBb0M7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHNEQUFTO0FBQ2I7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixpQ0FBaUMsZ0NBQWdDO0FBQ2pFLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0RBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsUUFBUSxpQkFBaUIsYUFBYSxXQUFXLEtBQUssWUFBWSxNQUFNLGdCQUFnQjtBQUN2SjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0YsT0FBTyxzREFBUztBQUNsRywyQkFBMkIsc0RBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUIsSUFBSTtBQUNyQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxzREFBYSxDQUFDLHNEQUFhLDJCQUEyQixzREFBbUI7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw4Q0FBTTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkMsNEJBQTRCLHNEQUFRLENBQUMsc0RBQVEsR0FBRztBQUNoRDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQVEsQ0FBQyxzREFBUSxHQUFHLGlCQUFpQjtBQUN6RDtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVMsSUFBSTtBQUNiLHFDQUFxQyxzREFBaUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQVc7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQVEsQ0FBQyxzREFBUSxHQUFHLGlCQUFpQjtBQUN6RDtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVMsSUFBSTtBQUNiLHNCQUFzQixzREFBUSxDQUFDLHNEQUFRLEdBQUcsbUJBQW1CO0FBQzdELG9oQkFBb2hCLGtEQUFnQiw4SEFBOEg7QUFDbHFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQVEsQ0FBQyxzREFBUSxHQUFHLGlCQUFpQjtBQUN6RDtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVMsSUFBSTtBQUNiO0FBQ0E7QUFDQSxtQ0FBbUMsbUJBQW1CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsaUNBQWlDLGtCQUFrQjtBQUNuRCxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsU0FBUyxJQUFJO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsc0RBQXNCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFVO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyxpREFBYzs7QUFFVyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vLi4vbm9kZV9tb2R1bGVzL0Bjb2Rlc2FuZGJveC9zYW5kcGFjay1jbGllbnQvZGlzdC9jbGllbnRzL3J1bnRpbWUvaW5kZXgubWpzPzg4MzEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXyBhcyBfX2F3YWl0ZXIsIGEgYXMgX19nZW5lcmF0b3IsIGggYXMgX19hc3NpZ24sIGkgYXMgX19zcHJlYWRBcnJheSwgZyBhcyBfX2V4dGVuZHMsIGIgYXMgY3JlYXRlUGFja2FnZUpTT04sIGMgYXMgY3JlYXRlRXJyb3IsIFMgYXMgU2FuZHBhY2tMb2dMZXZlbCwgZCBhcyBhZGRQYWNrYWdlSlNPTklmTmVlZGVkLCBuIGFzIG51bGx0aHJvd3MsIGUgYXMgZXh0cmFjdEVycm9yRGV0YWlscyB9IGZyb20gJy4uLy4uL3R5cGVzLTA4NzdjNTUzLm1qcyc7XG5pbXBvcnQgeyBkZXF1YWwgfSBmcm9tICdkZXF1YWwnO1xuaW1wb3J0IHsgUyBhcyBTYW5kcGFja0NsaWVudCB9IGZyb20gJy4uLy4uL2Jhc2UtODBhMWY3NjAubWpzJztcbmltcG9ydCAnb3V0dmFyaWFudCc7XG5cbi8qKlxuICogVGhpcyBmaWxlIGlzIGEgY29weSBvZiB0aGUgcmVzb2x2ZXIgZnJvbSB0aGUgYGNvZGVzYW5kYm94LWFwaWAgcGFja2FnZS5cbiAqIFdlIHdhbnRlZCB0byBhdm9pZCB0byByZWZlcmVuY2UgY29kZXNhbmRib3gtYXBpIGJlY2F1c2Ugb2YgdGhlIGNvZGUgdGhhdCBydW5zIG9uIGxvYWQgaW4gdGhlIHBhY2thZ2UuXG4gKiBUaGUgcGxhbiBpcyB0byB0YWtlIHNvbWUgdGltZSBhbmQgcmVmYWN0b3IgY29kZXNhbmRib3gtYXBpIGludG8gd2hhdCBpdCB3YXMgc3VwcG9zZWQgdG8gYmUgaW4gdGhlIGZpcnN0IHBsYWNlLFxuICogYW4gYWJzdHJhY3Rpb24gb3ZlciB0aGUgYWN0aW9ucyB0aGF0IGNhbiBiZSBkaXNwYXRjaGVkIGJldHdlZW4gdGhlIGJ1bmRsZXIgYW5kIHRoZSBpZnJhbWUuXG4gKi9cbnZhciBQcm90b2NvbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQcm90b2NvbCh0eXBlLCBoYW5kbGVNZXNzYWdlLCBwcm90b2NvbCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLmhhbmRsZU1lc3NhZ2UgPSBoYW5kbGVNZXNzYWdlO1xuICAgICAgICB0aGlzLnByb3RvY29sID0gcHJvdG9jb2w7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VNZXNzYWdlTGlzdGVuZXIgPSB0aGlzLnByb3RvY29sLmNoYW5uZWxMaXN0ZW4oZnVuY3Rpb24gKG1zZykgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UsIHJlc3VsdCwgcmVzcG9uc2UsIGVycl8xLCByZXNwb25zZTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG1zZy50eXBlID09PSB0aGlzLmdldFR5cGVJZCgpICYmIG1zZy5tZXRob2QpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtc2c7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmhhbmRsZU1lc3NhZ2UobWVzc2FnZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB0aGlzLmdldFR5cGVJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZ0lkOiBtZXNzYWdlLm1zZ0lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvdG9jb2wuZGlzcGF0Y2gocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdGhpcy5nZXRUeXBlSWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2dJZDogbWVzc2FnZS5tc2dJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJfMS5tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm90b2NvbC5kaXNwYXRjaChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9KTtcbiAgICB9XG4gICAgUHJvdG9jb2wucHJvdG90eXBlLmdldFR5cGVJZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwicHJvdG9jb2wtXCIuY29uY2F0KHRoaXMudHlwZSk7XG4gICAgfTtcbiAgICBQcm90b2NvbC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGlzcG9zZU1lc3NhZ2VMaXN0ZW5lcigpO1xuICAgIH07XG4gICAgcmV0dXJuIFByb3RvY29sO1xufSgpKTtcblxudmFyIElGcmFtZVByb3RvY29sID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIElGcmFtZVByb3RvY29sKGlmcmFtZSwgb3JpZ2luKSB7XG4gICAgICAgIC8vIFJlYWN0IHRvIG1lc3NhZ2VzIGZyb20gYW55IGlmcmFtZVxuICAgICAgICB0aGlzLmdsb2JhbExpc3RlbmVycyA9IHt9O1xuICAgICAgICB0aGlzLmdsb2JhbExpc3RlbmVyc0NvdW50ID0gMDtcbiAgICAgICAgLy8gUmVhY3QgdG8gbWVzc2FnZXMgZnJvbSB0aGUgaWZyYW1lIG93bmVkIGJ5IHRoaXMgaW5zdGFuY2VcbiAgICAgICAgdGhpcy5jaGFubmVsTGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMuY2hhbm5lbExpc3RlbmVyc0NvdW50ID0gMDtcbiAgICAgICAgLy8gUmFuZG9tIG51bWJlciB0byBpZGVudGlmeSB0aGlzIGluc3RhbmNlIG9mIHRoZSBjbGllbnQgd2hlbiBtZXNzYWdlcyBhcmUgY29taW5nIGZyb20gbXVsdGlwbGUgaWZyYW1lc1xuICAgICAgICB0aGlzLmNoYW5uZWxJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApO1xuICAgICAgICB0aGlzLmZyYW1lV2luZG93ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3c7XG4gICAgICAgIHRoaXMub3JpZ2luID0gb3JpZ2luO1xuICAgICAgICB0aGlzLmdsb2JhbExpc3RlbmVycyA9IFtdO1xuICAgICAgICB0aGlzLmNoYW5uZWxMaXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVyID0gdGhpcy5ldmVudExpc3RlbmVyLmJpbmQodGhpcyk7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5ldmVudExpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBJRnJhbWVQcm90b2NvbC5wcm90b3R5cGUuY2xlYW51cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMuZXZlbnRMaXN0ZW5lcik7XG4gICAgICAgIHRoaXMuZ2xvYmFsTGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMuY2hhbm5lbExpc3RlbmVycyA9IHt9O1xuICAgICAgICB0aGlzLmdsb2JhbExpc3RlbmVyc0NvdW50ID0gMDtcbiAgICAgICAgdGhpcy5jaGFubmVsTGlzdGVuZXJzQ291bnQgPSAwO1xuICAgIH07XG4gICAgLy8gU2VuZHMgdGhlIGNoYW5uZWxJZCBhbmQgdHJpZ2dlcnMgYW4gaWZyYW1lSGFuZHNoYWtlIHByb21pc2UgdG8gcmVzb2x2ZSxcbiAgICAvLyBzbyB0aGUgaWZyYW1lIGNhbiBzdGFydCBsaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzIChiYXNlZCBvbiB0aGUgaWQpXG4gICAgSUZyYW1lUHJvdG9jb2wucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuZnJhbWVXaW5kb3cpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZyYW1lV2luZG93LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIHR5cGU6IFwicmVnaXN0ZXItZnJhbWVcIixcbiAgICAgICAgICAgIG9yaWdpbjogZG9jdW1lbnQubG9jYXRpb24ub3JpZ2luLFxuICAgICAgICAgICAgaWQ6IHRoaXMuY2hhbm5lbElkLFxuICAgICAgICB9LCB0aGlzLm9yaWdpbik7XG4gICAgfTtcbiAgICAvLyBNZXNzYWdlcyBhcmUgZGlzcGF0Y2hlZCBmcm9tIHRoZSBjbGllbnQgZGlyZWN0bHkgdG8gdGhlIGluc3RhbmNlIGlmcmFtZVxuICAgIElGcmFtZVByb3RvY29sLnByb3RvdHlwZS5kaXNwYXRjaCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIGlmICghdGhpcy5mcmFtZVdpbmRvdykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnJhbWVXaW5kb3cucG9zdE1lc3NhZ2UoX19hc3NpZ24oeyAkaWQ6IHRoaXMuY2hhbm5lbElkLCBjb2Rlc2FuZGJveDogdHJ1ZSB9LCBtZXNzYWdlKSwgdGhpcy5vcmlnaW4pO1xuICAgIH07XG4gICAgLy8gQWRkIGEgbGlzdGVuZXIgdGhhdCBpcyBjYWxsZWQgb24gYW55IG1lc3NhZ2UgY29taW5nIGZyb20gYW4gaWZyYW1lIGluIHRoZSBwYWdlXG4gICAgLy8gVGhpcyBpcyBuZWVkZWQgZm9yIHRoZSBgaW5pdGlhbGl6ZWAgbWVzc2FnZSB3aGljaCBjb21lcyB3aXRob3V0IGEgY2hhbm5lbElkXG4gICAgSUZyYW1lUHJvdG9jb2wucHJvdG90eXBlLmdsb2JhbExpc3RlbiA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGlzdGVuZXJJZCA9IHRoaXMuZ2xvYmFsTGlzdGVuZXJzQ291bnQ7XG4gICAgICAgIHRoaXMuZ2xvYmFsTGlzdGVuZXJzW2xpc3RlbmVySWRdID0gbGlzdGVuZXI7XG4gICAgICAgIHRoaXMuZ2xvYmFsTGlzdGVuZXJzQ291bnQrKztcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5nbG9iYWxMaXN0ZW5lcnNbbGlzdGVuZXJJZF07XG4gICAgICAgIH07XG4gICAgfTtcbiAgICAvLyBBZGQgYSBsaXN0ZW5lciB0aGF0IGlzIGNhbGxlZCBvbiBhbnkgbWVzc2FnZSBjb21pbmcgZnJvbSBhbiBpZnJhbWUgd2l0aCB0aGUgaW5zdGFuY2UgY2hhbm5lbElkXG4gICAgLy8gQWxsIG90aGVyIG1lc3NhZ2VzIChlZzogZnJvbSBvdGhlciBpZnJhbWVzKSBhcmUgaWdub3JlZFxuICAgIElGcmFtZVByb3RvY29sLnByb3RvdHlwZS5jaGFubmVsTGlzdGVuID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ZW5lcklkID0gdGhpcy5jaGFubmVsTGlzdGVuZXJzQ291bnQ7XG4gICAgICAgIHRoaXMuY2hhbm5lbExpc3RlbmVyc1tsaXN0ZW5lcklkXSA9IGxpc3RlbmVyO1xuICAgICAgICB0aGlzLmNoYW5uZWxMaXN0ZW5lcnNDb3VudCsrO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZGVsZXRlIF90aGlzLmNoYW5uZWxMaXN0ZW5lcnNbbGlzdGVuZXJJZF07XG4gICAgICAgIH07XG4gICAgfTtcbiAgICAvLyBIYW5kbGVzIG1lc3NhZ2Ugd2luZG93cyBjb21pbmcgZnJvbSBpZnJhbWVzXG4gICAgSUZyYW1lUHJvdG9jb2wucHJvdG90eXBlLmV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgIC8vIHNraXAgZXZlbnRzIG9yaWdpbmF0aW5nIGZyb20gZGlmZmVyZW50IGlmcmFtZXNcbiAgICAgICAgaWYgKGV2dC5zb3VyY2UgIT09IHRoaXMuZnJhbWVXaW5kb3cpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWVzc2FnZSA9IGV2dC5kYXRhO1xuICAgICAgICBpZiAoIW1lc3NhZ2UuY29kZXNhbmRib3gpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMuZ2xvYmFsTGlzdGVuZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3RlbmVyKG1lc3NhZ2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG1lc3NhZ2UuJGlkICE9PSB0aGlzLmNoYW5uZWxJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5jaGFubmVsTGlzdGVuZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3RlbmVyKG1lc3NhZ2UpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBJRnJhbWVQcm90b2NvbDtcbn0oKSk7XG5cbnZhciBNQVhfQ0xJRU5UX0RFUEVOREVOQ1lfQ09VTlQgPSA1MDtcbmZ1bmN0aW9uIGdldFRlbXBsYXRlKHBrZywgXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5tb2R1bGVzKSB7XG4gICAgaWYgKCFwa2cpIHtcbiAgICAgICAgcmV0dXJuIFwic3RhdGljXCI7XG4gICAgfVxuICAgIHZhciBfYSA9IHBrZy5kZXBlbmRlbmNpZXMsIGRlcGVuZGVuY2llcyA9IF9hID09PSB2b2lkIDAgPyB7fSA6IF9hLCBfYiA9IHBrZy5kZXZEZXBlbmRlbmNpZXMsIGRldkRlcGVuZGVuY2llcyA9IF9iID09PSB2b2lkIDAgPyB7fSA6IF9iO1xuICAgIHZhciB0b3RhbERlcGVuZGVuY2llcyA9IF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgT2JqZWN0LmtleXMoZGVwZW5kZW5jaWVzKSwgdHJ1ZSksIE9iamVjdC5rZXlzKGRldkRlcGVuZGVuY2llcyksIHRydWUpO1xuICAgIHZhciBtb2R1bGVOYW1lcyA9IE9iamVjdC5rZXlzKG1vZHVsZXMpO1xuICAgIHZhciBhZG9uaXMgPSBbXCJAYWRvbmlzanMvZnJhbWV3b3JrXCIsIFwiQGFkb25pc2pzL2NvcmVcIl07XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLnNvbWUoZnVuY3Rpb24gKGRlcCkgeyByZXR1cm4gYWRvbmlzLmluZGV4T2YoZGVwKSA+IC0xOyB9KSkge1xuICAgICAgICByZXR1cm4gXCJhZG9uaXNcIjtcbiAgICB9XG4gICAgdmFyIG51eHQgPSBbXCJudXh0XCIsIFwibnV4dC1lZGdlXCIsIFwibnV4dC10c1wiLCBcIm51eHQtdHMtZWRnZVwiLCBcIm51eHQzXCJdO1xuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5zb21lKGZ1bmN0aW9uIChkZXApIHsgcmV0dXJuIG51eHQuaW5kZXhPZihkZXApID4gLTE7IH0pKSB7XG4gICAgICAgIHJldHVybiBcIm51eHRcIjtcbiAgICB9XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJuZXh0XCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwibmV4dFwiO1xuICAgIH1cbiAgICB2YXIgYXBvbGxvID0gW1xuICAgICAgICBcImFwb2xsby1zZXJ2ZXJcIixcbiAgICAgICAgXCJhcG9sbG8tc2VydmVyLWV4cHJlc3NcIixcbiAgICAgICAgXCJhcG9sbG8tc2VydmVyLWhhcGlcIixcbiAgICAgICAgXCJhcG9sbG8tc2VydmVyLWtvYVwiLFxuICAgICAgICBcImFwb2xsby1zZXJ2ZXItbGFtYmRhXCIsXG4gICAgICAgIFwiYXBvbGxvLXNlcnZlci1taWNyb1wiLFxuICAgIF07XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLnNvbWUoZnVuY3Rpb24gKGRlcCkgeyByZXR1cm4gYXBvbGxvLmluZGV4T2YoZGVwKSA+IC0xOyB9KSkge1xuICAgICAgICByZXR1cm4gXCJhcG9sbG9cIjtcbiAgICB9XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJtZHgtZGVja1wiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcIm1keC1kZWNrXCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwiZ3JpZHNvbWVcIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJncmlkc29tZVwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcInZ1ZXByZXNzXCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwidnVlcHJlc3NcIjtcbiAgICB9XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJlbWJlci1jbGlcIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJlbWJlclwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcInNhcHBlclwiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcInNhcHBlclwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcImdhdHNieVwiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcImdhdHNieVwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcInF1YXNhclwiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcInF1YXNhclwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcIkBkb2N1c2F1cnVzL2NvcmVcIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJkb2N1c2F1cnVzXCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwicmVtaXhcIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJyZW1peFwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcImFzdHJvXCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwibm9kZVwiO1xuICAgIH1cbiAgICAvLyBDTElFTlRcbiAgICBpZiAobW9kdWxlTmFtZXMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5lbmRzV2l0aChcIi5yZVwiKTsgfSkpIHtcbiAgICAgICAgcmV0dXJuIFwicmVhc29uXCI7XG4gICAgfVxuICAgIHZhciBwYXJjZWwgPSBbXCJwYXJjZWwtYnVuZGxlclwiLCBcInBhcmNlbFwiXTtcbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuc29tZShmdW5jdGlvbiAoZGVwKSB7IHJldHVybiBwYXJjZWwuaW5kZXhPZihkZXApID4gLTE7IH0pKSB7XG4gICAgICAgIHJldHVybiBcInBhcmNlbFwiO1xuICAgIH1cbiAgICB2YXIgZG9qbyA9IFtcIkBkb2pvL2NvcmVcIiwgXCJAZG9qby9mcmFtZXdvcmtcIl07XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLnNvbWUoZnVuY3Rpb24gKGRlcCkgeyByZXR1cm4gZG9qby5pbmRleE9mKGRlcCkgPiAtMTsgfSkpIHtcbiAgICAgICAgcmV0dXJuIFwiQGRvam8vY2xpLWNyZWF0ZS1hcHBcIjtcbiAgICB9XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJAbmVzdGpzL2NvcmVcIikgPiAtMSB8fFxuICAgICAgICB0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwiQG5lc3Rqcy9jb21tb25cIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJuZXN0XCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwicmVhY3Qtc3R5bGVndWlkaXN0XCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwic3R5bGVndWlkaXN0XCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwicmVhY3Qtc2NyaXB0c1wiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcImNyZWF0ZS1yZWFjdC1hcHBcIjtcbiAgICB9XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJyZWFjdC1zY3JpcHRzLXRzXCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwiY3JlYXRlLXJlYWN0LWFwcC10eXBlc2NyaXB0XCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwiQGFuZ3VsYXIvY29yZVwiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcImFuZ3VsYXItY2xpXCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwicHJlYWN0LWNsaVwiKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBcInByZWFjdC1jbGlcIjtcbiAgICB9XG4gICAgaWYgKHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJAc3ZlbHRlY2gvcm91dGlmeVwiKSA+IC0xIHx8XG4gICAgICAgIHRvdGFsRGVwZW5kZW5jaWVzLmluZGV4T2YoXCJAcm94aS9yb3V0aWZ5XCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwibm9kZVwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcInZpdGVcIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJub2RlXCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwiQGZyb250aXR5L2NvcmVcIikgPiAtMSkge1xuICAgICAgICByZXR1cm4gXCJub2RlXCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwic3ZlbHRlXCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwic3ZlbHRlXCI7XG4gICAgfVxuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5pbmRleE9mKFwidnVlXCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwidnVlLWNsaVwiO1xuICAgIH1cbiAgICBpZiAodG90YWxEZXBlbmRlbmNpZXMuaW5kZXhPZihcImN4XCIpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIFwiY3hqc1wiO1xuICAgIH1cbiAgICB2YXIgbm9kZURlcHMgPSBbXG4gICAgICAgIFwiZXhwcmVzc1wiLFxuICAgICAgICBcImtvYVwiLFxuICAgICAgICBcIm5vZGVtb25cIixcbiAgICAgICAgXCJ0cy1ub2RlXCIsXG4gICAgICAgIFwiQHRlbnNvcmZsb3cvdGZqcy1ub2RlXCIsXG4gICAgICAgIFwid2VicGFjay1kZXYtc2VydmVyXCIsXG4gICAgICAgIFwic25vd3BhY2tcIixcbiAgICBdO1xuICAgIGlmICh0b3RhbERlcGVuZGVuY2llcy5zb21lKGZ1bmN0aW9uIChkZXApIHsgcmV0dXJuIG5vZGVEZXBzLmluZGV4T2YoZGVwKSA+IC0xOyB9KSkge1xuICAgICAgICByZXR1cm4gXCJub2RlXCI7XG4gICAgfVxuICAgIGlmIChPYmplY3Qua2V5cyhkZXBlbmRlbmNpZXMpLmxlbmd0aCA+PSBNQVhfQ0xJRU5UX0RFUEVOREVOQ1lfQ09VTlQpIHtcbiAgICAgICAgLy8gVGhlIGRlcGVuZGVuY2llcyBhcmUgdG9vIG11Y2ggZm9yIGNsaWVudCBzYW5kYm94ZXMgdG8gaGFuZGxlXG4gICAgICAgIHJldHVybiBcIm5vZGVcIjtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxudmFyIF9hO1xudmFyIEJVTkRMRVJfVVJMID0gXCJodHRwczovL1wiLmNvbmNhdCgoX2EgPSBcIjIuMTMuMlwiKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVwbGFjZSgvXFwuL2csIFwiLVwiKSwgXCItc2FuZHBhY2suY29kZXNhbmRib3guaW8vXCIpO1xudmFyIFNhbmRwYWNrUnVudGltZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2FuZHBhY2tSdW50aW1lLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNhbmRwYWNrUnVudGltZShzZWxlY3Rvciwgc2FuZGJveFNldHVwLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNlbGVjdG9yLCBzYW5kYm94U2V0dXAsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmdldFRyYW5zcGlsZXJDb250ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVuc3Vic2NyaWJlID0gX3RoaXMubGlzdGVuKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09IFwidHJhbnNwaWxlci1jb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobWVzc2FnZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwiZ2V0LXRyYW5zcGlsZXItY29udGV4dFwiIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmJ1bmRsZXJVUkwgPSBvcHRpb25zLmJ1bmRsZXJVUkwgfHwgQlVORExFUl9VUkw7XG4gICAgICAgIGlmIChvcHRpb25zLnRlYW1JZCkge1xuICAgICAgICAgICAgX3RoaXMuYnVuZGxlclVSTCA9XG4gICAgICAgICAgICAgICAgX3RoaXMuYnVuZGxlclVSTC5yZXBsYWNlKFwiaHR0cHM6Ly9cIiwgXCJodHRwczovL1wiICsgb3B0aW9ucy50ZWFtSWQgKyBcIi1cIikgK1xuICAgICAgICAgICAgICAgICAgICBcIj9jYWNoZT1cIi5jb25jYXQoRGF0ZS5ub3coKSk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuYnVuZGxlclN0YXRlID0gdW5kZWZpbmVkO1xuICAgICAgICBfdGhpcy5lcnJvcnMgPSBbXTtcbiAgICAgICAgX3RoaXMuc3RhdHVzID0gXCJpbml0aWFsaXppbmdcIjtcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgX3RoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICAgICAgICBudWxsdGhyb3dzKGVsZW1lbnQsIFwiVGhlIGVsZW1lbnQgJ1wiLmNvbmNhdChzZWxlY3RvciwgXCInIHdhcyBub3QgZm91bmRcIikpO1xuICAgICAgICAgICAgX3RoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgICAgICBfdGhpcy5pZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICAgICAgICAgICAgX3RoaXMuaW5pdGlhbGl6ZUVsZW1lbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLmVsZW1lbnQgPSBzZWxlY3RvcjtcbiAgICAgICAgICAgIF90aGlzLmlmcmFtZSA9IHNlbGVjdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmICghX3RoaXMuaWZyYW1lLmdldEF0dHJpYnV0ZShcInNhbmRib3hcIikpIHtcbiAgICAgICAgICAgIF90aGlzLmlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzYW5kYm94XCIsIFwiYWxsb3ctZm9ybXMgYWxsb3ctbW9kYWxzIGFsbG93LXBvcHVwcyBhbGxvdy1wcmVzZW50YXRpb24gYWxsb3ctc2FtZS1vcmlnaW4gYWxsb3ctc2NyaXB0cyBhbGxvdy1kb3dubG9hZHMgYWxsb3ctcG9pbnRlci1sb2NrXCIpO1xuICAgICAgICAgICAgX3RoaXMuaWZyYW1lLnNldEF0dHJpYnV0ZShcImFsbG93XCIsIFwiYWNjZWxlcm9tZXRlcjsgY2FtZXJhOyBlbmNyeXB0ZWQtbWVkaWE7IGdlb2xvY2F0aW9uOyBneXJvc2NvcGU7IGhpZDsgbWljcm9waG9uZTsgbWlkaTsgY2xpcGJvYXJkLXdyaXRlO1wiKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5zZXRMb2NhdGlvblVSTEludG9JRnJhbWUoKTtcbiAgICAgICAgX3RoaXMuaWZyYW1lUHJvdG9jb2wgPSBuZXcgSUZyYW1lUHJvdG9jb2woX3RoaXMuaWZyYW1lLCBfdGhpcy5idW5kbGVyVVJMKTtcbiAgICAgICAgX3RoaXMudW5zdWJzY3JpYmVHbG9iYWxMaXN0ZW5lciA9IF90aGlzLmlmcmFtZVByb3RvY29sLmdsb2JhbExpc3RlbihmdW5jdGlvbiAobWVzKSB7XG4gICAgICAgICAgICBpZiAobWVzLnR5cGUgIT09IFwiaW5pdGlhbGl6ZWRcIiB8fCAhX3RoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5pZnJhbWVQcm90b2NvbC5yZWdpc3RlcigpO1xuICAgICAgICAgICAgaWYgKF90aGlzLm9wdGlvbnMuZmlsZVJlc29sdmVyKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZmlsZVJlc29sdmVyUHJvdG9jb2wgPSBuZXcgUHJvdG9jb2woXCJmc1wiLCBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5tZXRob2QgPT09IFwiaXNGaWxlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLm9wdGlvbnMuZmlsZVJlc29sdmVyLmlzRmlsZShkYXRhLnBhcmFtc1swXSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5tZXRob2QgPT09IFwicmVhZEZpbGVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMub3B0aW9ucy5maWxlUmVzb2x2ZXIucmVhZEZpbGUoZGF0YS5wYXJhbXNbMF0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1ldGhvZCBub3Qgc3VwcG9ydGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTsgfSwgX3RoaXMuaWZyYW1lUHJvdG9jb2wpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMudXBkYXRlU2FuZGJveChfdGhpcy5zYW5kYm94U2V0dXAsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMudW5zdWJzY3JpYmVDaGFubmVsTGlzdGVuZXIgPSBfdGhpcy5pZnJhbWVQcm90b2NvbC5jaGFubmVsTGlzdGVuKGZ1bmN0aW9uIChtZXMpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobWVzLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic3RhcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5lcnJvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJzdGF0dXNcIjoge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdGF0dXMgPSBtZXMuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBcImFjdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXMuYWN0aW9uID09PSBcInNob3ctZXJyb3JcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZXJyb3JzID0gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBfdGhpcy5lcnJvcnMsIHRydWUpLCBbZXh0cmFjdEVycm9yRGV0YWlscyhtZXMpXSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIFwiZG9uZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXR1cyA9IFwiZG9uZVwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBcInN0YXRlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuYnVuZGxlclN0YXRlID0gbWVzLnN0YXRlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNhbmRwYWNrUnVudGltZS5wcm90b3R5cGUuc2V0TG9jYXRpb25VUkxJbnRvSUZyYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciB1cmxTb3VyY2UgPSB0aGlzLm9wdGlvbnMuc3RhcnRSb3V0ZVxuICAgICAgICAgICAgPyBuZXcgVVJMKHRoaXMub3B0aW9ucy5zdGFydFJvdXRlLCB0aGlzLmJ1bmRsZXJVUkwpLnRvU3RyaW5nKClcbiAgICAgICAgICAgIDogdGhpcy5idW5kbGVyVVJMO1xuICAgICAgICAoX2EgPSB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubG9jYXRpb24ucmVwbGFjZSh1cmxTb3VyY2UpO1xuICAgICAgICB0aGlzLmlmcmFtZS5zcmMgPSB1cmxTb3VyY2U7XG4gICAgfTtcbiAgICBTYW5kcGFja1J1bnRpbWUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVDaGFubmVsTGlzdGVuZXIoKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZUdsb2JhbExpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMuaWZyYW1lUHJvdG9jb2wuY2xlYW51cCgpO1xuICAgIH07XG4gICAgU2FuZHBhY2tSdW50aW1lLnByb3RvdHlwZS51cGRhdGVPcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFkZXF1YWwodGhpcy5vcHRpb25zLCBvcHRpb25zKSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2FuZGJveCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTYW5kcGFja1J1bnRpbWUucHJvdG90eXBlLnVwZGF0ZVNhbmRib3ggPSBmdW5jdGlvbiAoc2FuZGJveFNldHVwLCBpc0luaXRpYWxpemF0aW9uQ29tcGlsZSkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIGlmIChzYW5kYm94U2V0dXAgPT09IHZvaWQgMCkgeyBzYW5kYm94U2V0dXAgPSB0aGlzLnNhbmRib3hTZXR1cDsgfVxuICAgICAgICB0aGlzLnNhbmRib3hTZXR1cCA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCB0aGlzLnNhbmRib3hTZXR1cCksIHNhbmRib3hTZXR1cCk7XG4gICAgICAgIHZhciBmaWxlcyA9IHRoaXMuZ2V0RmlsZXMoKTtcbiAgICAgICAgdmFyIG1vZHVsZXMgPSBPYmplY3Qua2V5cyhmaWxlcykucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBuZXh0KSB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICByZXR1cm4gKF9fYXNzaWduKF9fYXNzaWduKHt9LCBwcmV2KSwgKF9hID0ge30sIF9hW25leHRdID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IGZpbGVzW25leHRdLmNvZGUsXG4gICAgICAgICAgICAgICAgcGF0aDogbmV4dCxcbiAgICAgICAgICAgIH0sIF9hKSkpO1xuICAgICAgICB9LCB7fSk7XG4gICAgICAgIHZhciBwYWNrYWdlSlNPTiA9IEpTT04ucGFyc2UoY3JlYXRlUGFja2FnZUpTT04odGhpcy5zYW5kYm94U2V0dXAuZGVwZW5kZW5jaWVzLCB0aGlzLnNhbmRib3hTZXR1cC5kZXZEZXBlbmRlbmNpZXMsIHRoaXMuc2FuZGJveFNldHVwLmVudHJ5KSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBwYWNrYWdlSlNPTiA9IEpTT04ucGFyc2UoZmlsZXNbXCIvcGFja2FnZS5qc29uXCJdLmNvZGUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGNyZWF0ZUVycm9yKFwiY291bGQgbm90IHBhcnNlIHBhY2thZ2UuanNvbiBmaWxlOiBcIiArIGUubWVzc2FnZSkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRPRE8gbW92ZSB0aGlzIHRvIGEgY29tbW9uIGZvcm1hdFxuICAgICAgICB2YXIgbm9ybWFsaXplZE1vZHVsZXMgPSBPYmplY3Qua2V5cyhmaWxlcykucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBuZXh0KSB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICByZXR1cm4gKF9fYXNzaWduKF9fYXNzaWduKHt9LCBwcmV2KSwgKF9hID0ge30sIF9hW25leHRdID0ge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZpbGVzW25leHRdLmNvZGUsXG4gICAgICAgICAgICAgICAgcGF0aDogbmV4dCxcbiAgICAgICAgICAgIH0sIF9hKSkpO1xuICAgICAgICB9LCB7fSk7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2goX19hc3NpZ24oX19hc3NpZ24oe30sIHRoaXMub3B0aW9ucyksIHsgdHlwZTogXCJjb21waWxlXCIsIGNvZGVzYW5kYm94OiB0cnVlLCB2ZXJzaW9uOiAzLCBpc0luaXRpYWxpemF0aW9uQ29tcGlsZTogaXNJbml0aWFsaXphdGlvbkNvbXBpbGUsIG1vZHVsZXM6IG1vZHVsZXMsIHJlYWN0RGV2VG9vbHM6IHRoaXMub3B0aW9ucy5yZWFjdERldlRvb2xzLCBleHRlcm5hbFJlc291cmNlczogdGhpcy5vcHRpb25zLmV4dGVybmFsUmVzb3VyY2VzIHx8IFtdLCBoYXNGaWxlUmVzb2x2ZXI6IEJvb2xlYW4odGhpcy5vcHRpb25zLmZpbGVSZXNvbHZlciksIGRpc2FibGVEZXBlbmRlbmN5UHJlcHJvY2Vzc2luZzogdGhpcy5zYW5kYm94U2V0dXAuZGlzYWJsZURlcGVuZGVuY3lQcmVwcm9jZXNzaW5nLCB0ZW1wbGF0ZTogdGhpcy5zYW5kYm94U2V0dXAudGVtcGxhdGUgfHxcbiAgICAgICAgICAgICAgICBnZXRUZW1wbGF0ZShwYWNrYWdlSlNPTiwgbm9ybWFsaXplZE1vZHVsZXMpLCBzaG93T3BlbkluQ29kZVNhbmRib3g6IChfYSA9IHRoaXMub3B0aW9ucy5zaG93T3BlbkluQ29kZVNhbmRib3gpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHRydWUsIHNob3dFcnJvclNjcmVlbjogKF9iID0gdGhpcy5vcHRpb25zLnNob3dFcnJvclNjcmVlbikgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogdHJ1ZSwgc2hvd0xvYWRpbmdTY3JlZW46IChfYyA9IHRoaXMub3B0aW9ucy5zaG93TG9hZGluZ1NjcmVlbikgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogZmFsc2UsIHNraXBFdmFsOiB0aGlzLm9wdGlvbnMuc2tpcEV2YWwgfHwgZmFsc2UsIGNsZWFyQ29uc29sZURpc2FibGVkOiAhdGhpcy5vcHRpb25zLmNsZWFyQ29uc29sZU9uRmlyc3RDb21waWxlLCBsb2dMZXZlbDogKF9kID0gdGhpcy5vcHRpb25zLmxvZ0xldmVsKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBTYW5kcGFja0xvZ0xldmVsLkluZm8sIGN1c3RvbU5wbVJlZ2lzdHJpZXM6IHRoaXMub3B0aW9ucy5jdXN0b21OcG1SZWdpc3RyaWVzLCB0ZWFtSWQ6IHRoaXMub3B0aW9ucy50ZWFtSWQsIHNhbmRib3hJZDogdGhpcy5vcHRpb25zLnNhbmRib3hJZCB9KSk7XG4gICAgfTtcbiAgICBTYW5kcGFja1J1bnRpbWUucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVyY2VwdCBcInJlZnJlc2hcIiBkaXNwYXRjaDogdGhpcyB3aWxsIG1ha2Ugc3VyZVxuICAgICAgICAgKiB0aGF0IHRoZSBpZnJhbWUgaXMgc3RpbGwgaW4gdGhlIGxvY2F0aW9uIGl0J3Mgc3VwcG9zZWQgdG8gYmUuXG4gICAgICAgICAqIEV4dGVybmFsIGxpbmtzIGluc2lkZSB0aGUgaWZyYW1lIHdpbGwgY2hhbmdlIHRoZSBsb2NhdGlvbiBhbmRcbiAgICAgICAgICogcHJldmVudCB0aGUgdXNlciBmcm9tIG5hdmlnYXRpbmcgYmFjay5cbiAgICAgICAgICovXG4gICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09IFwicmVmcmVzaFwiKSB7XG4gICAgICAgICAgICB0aGlzLnNldExvY2F0aW9uVVJMSW50b0lGcmFtZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaWZyYW1lUHJvdG9jb2wuZGlzcGF0Y2gobWVzc2FnZSk7XG4gICAgfTtcbiAgICBTYW5kcGFja1J1bnRpbWUucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICByZXR1cm4gdGhpcy5pZnJhbWVQcm90b2NvbC5jaGFubmVsTGlzdGVuKGxpc3RlbmVyKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgVVJMIG9mIHRoZSBjb250ZW50cyBvZiB0aGUgY3VycmVudCBzYW5kYm94XG4gICAgICovXG4gICAgU2FuZHBhY2tSdW50aW1lLnByb3RvdHlwZS5nZXRDb2RlU2FuZGJveFVSTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZpbGVzID0gdGhpcy5nZXRGaWxlcygpO1xuICAgICAgICB2YXIgcGFyYW1GaWxlcyA9IE9iamVjdC5rZXlzKGZpbGVzKS5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIG5leHQpIHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHJldHVybiAoX19hc3NpZ24oX19hc3NpZ24oe30sIHByZXYpLCAoX2EgPSB7fSwgX2FbbmV4dC5yZXBsYWNlKFwiL1wiLCBcIlwiKV0gPSB7XG4gICAgICAgICAgICAgICAgY29udGVudDogZmlsZXNbbmV4dF0uY29kZSxcbiAgICAgICAgICAgICAgICBpc0JpbmFyeTogZmFsc2UsXG4gICAgICAgICAgICB9LCBfYSkpKTtcbiAgICAgICAgfSwge30pO1xuICAgICAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2NvZGVzYW5kYm94LmlvL2FwaS92MS9zYW5kYm94ZXMvZGVmaW5lP2pzb249MVwiLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBmaWxlczogcGFyYW1GaWxlcyB9KSxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4Lmpzb24oKTsgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICBzYW5kYm94SWQ6IHJlcy5zYW5kYm94X2lkLFxuICAgICAgICAgICAgZWRpdG9yVXJsOiBcImh0dHBzOi8vY29kZXNhbmRib3guaW8vcy9cIi5jb25jYXQocmVzLnNhbmRib3hfaWQpLFxuICAgICAgICAgICAgZW1iZWRVcmw6IFwiaHR0cHM6Ly9jb2Rlc2FuZGJveC5pby9lbWJlZC9cIi5jb25jYXQocmVzLnNhbmRib3hfaWQpLFxuICAgICAgICB9KTsgfSk7XG4gICAgfTtcbiAgICBTYW5kcGFja1J1bnRpbWUucHJvdG90eXBlLmdldEZpbGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2FuZGJveFNldHVwID0gdGhpcy5zYW5kYm94U2V0dXA7XG4gICAgICAgIGlmIChzYW5kYm94U2V0dXAuZmlsZXNbXCIvcGFja2FnZS5qc29uXCJdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBhZGRQYWNrYWdlSlNPTklmTmVlZGVkKHNhbmRib3hTZXR1cC5maWxlcywgc2FuZGJveFNldHVwLmRlcGVuZGVuY2llcywgc2FuZGJveFNldHVwLmRldkRlcGVuZGVuY2llcywgc2FuZGJveFNldHVwLmVudHJ5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zYW5kYm94U2V0dXAuZmlsZXM7XG4gICAgfTtcbiAgICBTYW5kcGFja1J1bnRpbWUucHJvdG90eXBlLmluaXRpYWxpemVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlmcmFtZS5zdHlsZS5ib3JkZXIgPSBcIjBcIjtcbiAgICAgICAgdGhpcy5pZnJhbWUuc3R5bGUud2lkdGggPSB0aGlzLm9wdGlvbnMud2lkdGggfHwgXCIxMDAlXCI7XG4gICAgICAgIHRoaXMuaWZyYW1lLnN0eWxlLmhlaWdodCA9IHRoaXMub3B0aW9ucy5oZWlnaHQgfHwgXCIxMDAlXCI7XG4gICAgICAgIHRoaXMuaWZyYW1lLnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgbnVsbHRocm93cyh0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSwgXCJUaGUgZ2l2ZW4gaWZyYW1lIGRvZXMgbm90IGhhdmUgYSBwYXJlbnQuXCIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcy5pZnJhbWUsIHRoaXMuZWxlbWVudCk7XG4gICAgfTtcbiAgICByZXR1cm4gU2FuZHBhY2tSdW50aW1lO1xufShTYW5kcGFja0NsaWVudCkpO1xuXG5leHBvcnQgeyBTYW5kcGFja1J1bnRpbWUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../../node_modules/@codesandbox/sandpack-client/dist/clients/runtime/index.mjs\n"));

/***/ })

}]);